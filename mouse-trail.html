<!DOCTYPE html>

<html>
  <head>
    <title>Mouse Trail</title>
    <meta charset="utf-8" />

    <style>
      .trail {
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: red;
      }
    </style>
  </head>

  <body>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>
    <div class="trail"></div>

    <script>
      "use strict";

      const trail = createMouseTrailObject("trail");
      trail.start();

      function createMouseTrailObject(className) {
        const trail = document.getElementsByClassName(className);
        const trailItems = Array.from(trail);

        const initialDelayInMs = 20;
        const delayToAddToNextTrailElement = 30;

        function start() {
          addMouseMoveEventListener();
        }

        function addMouseMoveEventListener() {
          window.addEventListener("mousemove", (e) => {
            window.requestAnimationFrame(
              moveTrailToPosition(e.clientY, e.clientX)
            );
          });
        }

        function moveTrailToPosition(top = 0, left = 0) {
          let delay = initialDelayInMs;
          const topMargin = 20;
          const lefMargin = 5;

          trailItems.forEach((item) => {
            setTimeout(() => {
              item.style.top = `${top + topMargin}px`;
              item.style.left = `${left + lefMargin}px`;
            }, delay);

            delay += delayToAddToNextTrailElement;
          });
        }

        return {
          start,
        };
      }
    </script>
  </body>
</html>
